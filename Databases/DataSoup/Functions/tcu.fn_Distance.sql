create function tcu.fn_Distance
(	@frLat	decimal(9, 6)
,	@frLon	decimal(9, 6)
,	@toLat	decimal(9, 6)
,	@toLon	decimal(9, 6)	)
returns	decimal(5, 1)
/*
????????????????????????????????????????????????????????????????????????????????
			c 2000-08 ? Texans Credit Union ? All rights reserved.
????????????????????????????????????????????????????????????????????????????????
Developer:	Paul Hunter
Created  :	01/18/2008
Purpose  :	Used to calculate the distance in miles between two locations based
			on latitude and longitude.
History  :
   Date		Developer		Description
??????????	??????????????	????????????????????????????????????????????????????
????????????????????????????????????????????????????????????????????????????????
*/
begin
	return	cast(convert(float, (3956 * (2 * asin(sqrt(power(sin(((@frLat - @toLat) * 0.017453293) / 2), 2)
		+	cos(@frLat * 0.017453293) * cos(@toLat * 0.017453293)
		*	power(sin(((@frLon - @toLon) * 0.017453293) / 2), 2)))))) as decimal(5, 1))
end
GO
