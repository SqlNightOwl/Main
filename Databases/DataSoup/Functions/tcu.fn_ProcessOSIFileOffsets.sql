create function tcu.fn_ProcessOSIFileOffsets
GO
(	@runId		int
,	@processId	smallint	)
returns varchar(8000)
as
/*
????????????????????????????????????????????????????????????????????????????????
			c 2000-08 ? Texans Credit Union ? All rights reserved.
????????????????????????????????????????????????????????????????????????????????
Developer:	Paul Hunter
Created  :	02/06/2008
Purpose  :	Returns a semi-colon delimited list of the OSI Application files for
			a given Run and Process.  This funciton assumes that the files have 
			already been located and loaded into the table.  This funciton also
			assumes that the values will be added to the bas OSI Folder.  There 
			can be roughly 275 files returned by this funciton assuming an offset
			lenght of 29 characters.
History	 :
   Date		Developer		Description
??????????	??????????????	????????????????????????????????????????????????????
????????????????????????????????????????????????????????????????????????????????
*/
begin
	declare @list varchar(8000)
	set	@list = ''

	select	@list	= @list
					+ convert(char(8), EffectiveOn, 112)	-- daily folder
					+ replace('\|\', '|', QueNbr)			-- que sub folder
					+ FileName + ';'						-- file name
	from	tcu.ProcessOSILog
	where	RunId		= @runId
	and		ProcessId	= @processId

	if len(@list) > 0
		set @list = left(@list, len(@list) - 1)

	return nullif(@list, '')
end
GO
