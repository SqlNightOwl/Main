create function tcu.fn_Split
(	@string		varchar(max)
,	@delimiter	varchar(25)
)
returns @results table
(	value	varchar(max)	null
,	row		int identity	not null	primary key
)
as
/*
????????????????????????????????????????????????????????????????????????????????
			c 2000-09 ? Texans Credit Union ? All rights reserved.
????????????????????????????????????????????????????????????????????????????????
Developer:	Paul Hunter
Created	 :	07/07/2001
Purpose	 :	Splits the sting provided using the specified delimiter and returns
			the parts to the caller as a table.
History	 :
   Date		Developer		Description
??????????	??????????????	????????????????????????????????????????????????????
????????????????????????????????????????????????????????????????????????????????
*/
begin
	declare
		@pos	int
	,	@value	varchar(max)
	,	@dlen	int
	set	@dlen	= len(@delimiter);
	if @dlen = 0 and @delimiter is not null
		set	@dlen	= 1;
	while len(@String) > 0
	begin
		set	@pos = charindex(@delimiter, @string);
		if @pos > 0
		begin
			set	@value = left(@string, @pos -1);
			set	@string = substring(@string, @pos + @dlen, 8000);
		end;
		else
		begin
			set	@value = @string;
			set	@string = '';
		end;
		if len(@value) > 0
			insert @results (value) values (@value);
	end;
	return;
end;
GO
