create function tcu.fn_OSIFolder()
returns varchar(255)
as
/*
????????????????????????????????????????????????????????????????????????????????
			c 2000-09 ? Texans Credit Union ? All rights reserved.
????????????????????????????????????????????????????????????????????????????????
Developer:	Paul Hunter
Created  :	03/28/2007
Purpose  :	Standard function to return the UNC OSI output folder.
History	 :
   Date		Developer		Description
??????????	??????????????	????????????????????????????????????????????????????
09/22/2008	Paul Hunter		Folder names were normalized for the Development, QA
							and Production servers so that the file server name
							is stored in the Dictionary and the instance name
							drives the subfolder.
05/16/2009	Paul Hunter		Compiled against the DNA schema.
????????????????????????????????????????????????????????????????????????????????
*/
begin
	declare @return	varchar(255);
	select	@return	=	tcu.fn_Dictionary('OSI', 'File Server') + '\'
					+	case instance_name
						when 'TXPROD1' then '2007OSI'
						else upper(instance_name)
						end + '\OSI\RPTS\'
	from	openquery(OSI, 'SELECT INSTANCE_NAME FROM V$INSTANCE')
	return tcu.fn_UNCFileSpec(@return);
end;
GO
