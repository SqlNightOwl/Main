create function tcu.fn_FirstBusinessDay
(	@dateValue	datetime	)
returns datetime
as
/*
????????????????????????????????????????????????????????????????????????????????
			c 2000-08 ? Texans Credit Union ? All rights reserved.
????????????????????????????????????????????????????????????????????????????????
Developer:	Paul Hunter
Created  :	11/20/2005
Purpose  :	Returns the first business day of the month for the date value provided.
History	 :
   Date		Developer		Description
??????????	??????????????	????????????????????????????????????????????????????
????????????????????????????????????????????????????????????????????????????????
*/
begin

	-- get the first day of the month for the specified date
	set	@dateValue = isnull(@dateValue, getdate())
	set	@dateValue = convert(char(10), dateadd(day, -day(@dateValue) + 1, @dateValue), 101)

	--	January first is a special case becasue it's not a business day.
	if month(@dateValue) = 1 and day(@dateValue) = 1
		set	@dateValue = dateadd(day, 1, @dateValue)	

	while datepart(weekday, @dateValue) in (1, 7) -- sunday, saturday
	begin
		set	@dateValue = dateadd(day, 1, @dateValue)	
	end

	return @dateValue
end
GO
